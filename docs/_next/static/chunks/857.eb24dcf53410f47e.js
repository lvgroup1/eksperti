"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[857],{4857:(e,t,l)=>{l.r(t),l.d(t,{default:()=>p});var a=l(7876),i=l(4232);let n=["Swedbank","Gjensidige","Compensa","IF","BTA","Balta"],r=["Komerctelpa","Dzīvojamā ēka"],o=["Privātmāja","Daudzdzīvokļu māja","Rindu māja","Cits"],s=["CTA","Plūdi","Uguns","Koks","Cits"],d=["Jā","Nē"],c=["Virtuve","Guļamistaba","Koridors","Katla telpa","Dzīvojamā istaba","Vannas istaba","Tualete","Garderobe","Cits"];function u(e){if(null==e)return 0;let t=parseFloat(String(e).replace(/\s+/g,"").replace(",","."));return Number.isFinite(t)?t:0}function m(e){if(!e)return"";let t=String(e).trim().toLowerCase().replace("\xb2","2").replace("\xa0"," ").replace("  "," ");return"gb."===t||"gab."===t||"gab"===t?"gab":"m2"===t||"m 2"===t||"m^2"===t?"m2":"m3"===t||"m 3"===t||"m^3"===t?"m3":"m"===t?"m":"kpl"===t||"kpl."===t?"kpl":"diena"===t?"diena":"c/h"===t?"c/h":"obj."===t||"obj"===t?"obj":t}let g=["m2","m3","m","gab","kpl","diena","obj","c/h"];function p(){var e,t,p;let[h,b]=(0,i.useState)(1),[x,v]=(0,i.useState)(""),[j,f]=(0,i.useState)(""),[y,C]=(0,i.useState)(""),[k,w]=(0,i.useState)(""),[S,R]=(0,i.useState)("Balta"),[z,N]=(0,i.useState)(""),[B,I]=(0,i.useState)(""),[L,D]=(0,i.useState)(""),[F,T]=(0,i.useState)(""),[M,U]=(0,i.useState)(""),[A,E]=(0,i.useState)("Nē"),[P,_]=(0,i.useState)("Nē"),[J,O]=(0,i.useState)("Nē"),[K,W]=(0,i.useState)("Nē"),[V,q]=(0,i.useState)(""),[G,H]=(0,i.useState)(c.reduce((e,t)=>(e[t]={checked:!1,count:1,custom:""},e),{})),[Y,X]=(0,i.useState)([]),[Z,Q]=(0,i.useState)({}),[$,ee]=(0,i.useState)(null),[et,el]=(0,i.useState)([]),[ea,ei]=(0,i.useState)("");window.location.hostname.endsWith("github.io")||window.location.pathname.startsWith("/eksperti"),(0,i.useEffect)(()=>{if("Balta"!==S)return void el([]);ei(""),fetch("prices/balta.json").then(e=>{if(!e.ok)throw Error("".concat(e.status," ").concat(e.statusText));return e.json()}).then(e=>{el((Array.isArray(e.items)?e.items:[]).map((e,t)=>{var l,a,i,n,r,o,s;return{...e,id:String(null!=(l=e.id)?l:t),unit:m(e.unit),unit_price:u(e.unit_price),labor:u(null!=(a=e.labor)?a:e.darbs),materials:u(null!=(n=null!=(i=e.materials)?i:e.materiāli)?n:e.materiali),mechanisms:u(null!=(o=null!=(r=e.mechanisms)?r:e.mehānismi)?o:e.mehanismi),category:e.category||"",uid:"".concat(e.category||"—","::").concat(String(null!=(s=e.id)?s:t))}}))}).catch(e=>ei("Neizdevās ielādēt BALTA cenas: ".concat(e.message)))},[S]);let en=(0,i.useMemo)(()=>Array.from(new Set(et.map(e=>e.category).filter(Boolean))),[et]),er=(0,i.useMemo)(()=>{let e=new Set(g);return et.forEach(t=>t.unit&&e.add(m(t.unit))),Array.from(e)},[et]),[eo,es]=(0,i.useState)([]);function ed(e,t,l,a){Q(i=>{let n=[...i[e]||[]],r={...n[t],[l]:a};return n[t]=r,{...i,[e]:n}})}(0,i.useEffect)(()=>es(function(){try{let e=localStorage.getItem("tames_profils_saglabatie");return e?JSON.parse(e):[]}catch(e){return[]}}()),[]),(0,i.useEffect)(()=>{let e=[];Object.entries(G).forEach(t=>{let[l,a]=t;if(!a.checked)return;let i=Math.max(1,Number(a.count)||1);for(let t=1;t<=i;t++){let i="".concat(l,"-").concat(t),n=Y.find(e=>e.id===i);e.push({id:i,type:"Cits"===l?a.custom||"Cits":l,index:t,note:(null==n?void 0:n.note)||""})}}),X(e),Q(t=>{let l={};return e.forEach(e=>{l[e.id]=t[e.id]||[{category:"",itemId:"",itemName:"",quantity:"",unit:"",unit_price:null}]}),l})},[G]);let ec=(0,i.useMemo)(()=>{switch(h){case 1:return!!k.trim();case 2:return!!S;case 3:return!!z&&("Dzīvojamā ēka"!==z||!!B);case 4:return!!F&&("Cits"!==F||!!M.trim());case 5:return["Jā","Nē"].includes(A);case 6:return["Jā","Nē"].includes(P);case 7:return["Jā","Nē"].includes(J);case 8:return"Nē"===K||"Jā"===K&&!!V&&Number(V)>=0;case 9:return Object.values(G).some(e=>e.checked);default:return!0}},[h,k,S,z,B,F,M,A,P,J,K,V,G]);async function eu(){try{let e=await l.e(22).then(l.t.bind(l,1980,23)),t=(null==e?void 0:e.default)||e,a=window.location.hostname.endsWith("github.io")||window.location.pathname.startsWith("/eksperti")?"/eksperti":"",i="".concat(a,"/templates/balta_template.xlsx"),n=await fetch(i);if(!n.ok)return void alert("Neizdevās ielādēt ".concat(i,". Pārliecinies, ka fails ir public/templates/balta_template.xlsx"));let r=await n.arrayBuffer(),o=new t.Workbook;await o.xlsx.load(r);let s=o.getWorksheet("Tāme")||o.worksheets[0],d=o.addWorksheet("Tāme (izvade)",{views:[{showGridLines:!1}]}),c={name:"Calibri",size:11},g="#,##0.00",p={style:"thin"},h={top:p,left:p,bottom:p,right:p},b={type:"pattern",pattern:"solid",fgColor:{argb:"FFEFEFEF"}},x={type:"pattern",pattern:"solid",fgColor:{argb:"FFF3F6FD"}};d.getColumn(2).alignment={wrapText:!0,vertical:"middle"};let v=new Date().toLocaleDateString("lv-LV",{year:"numeric",month:"long",day:"numeric"}),j=e=>String(e).padStart(2,"0"),f=new Date,C="".concat(j(f.getDate())).concat(j(f.getMonth()+1)).concat(f.getFullYear());d.getCell("A1").value="Pasūtītājs: ".concat(S||"Balta"),d.getCell("A2").value="Objekts: ".concat(z||"").concat(B?" – "+B:""),d.getCell("A3").value="Objekta adrese: ".concat(k||""),d.getCell("A8").value="Rīga, ".concat(v),d.getCell("A9").value="Pamatojums: apdrošināšanas lieta Nr. ".concat(y||"—"),d.getCell("J1").value="LV GROUP SIA",d.getCell("J2").value="Reģ. Nr.: LV40003216553",d.getCell("J3").value="Banka: Luminor",d.getCell("J4").value="Konts: LV12RIKO0002012345678",d.mergeCells(6,2,6,12);let w=d.getCell(6,2);w.value="TĀME Nr. ".concat(C),w.font={...c,size:16,bold:!0},w.alignment={horizontal:"center",vertical:"middle"};let R=[];if(Y.forEach(e=>{(Z[e.id]||[]).forEach(t=>{var l,a,i,n;let r=u(t.quantity);if(r<=0)return;let o=et.find(e=>e.uid===t.itemUid)||et.find(e=>e.id===t.itemId);if(!o)return;let s=m(t.unit||o.unit||""),d=u(null!=(l=t.labor)?l:o.labor),c=u(null!=(a=t.materials)?a:o.materials),g=u(null!=(i=t.mechanisms)?i:o.mechanisms),p=d||c||g?d+c+g:u(null!=(n=t.unit_price)?n:o.unit_price);R.push({room:"".concat(e.type," ").concat(e.index),name:t.itemName||o.name||"",unit:s,qty:r,labor:d,materials:c,mechanisms:g,unitPrice:p})})}),!R.length)return void alert("Nav nevienas pozīcijas ar daudzumu.");R.sort((e,t)=>e.room.localeCompare(t.room)||e.name.localeCompare(t.name));for(let e of(d.getCell(13,1).value="Nr.",d.getCell(13,2).value="Darbu nosaukums",d.getCell(13,3).value="Mērv.",d.getCell(13,4).value="Daudz.",d.mergeCells(13,5,13,8),d.getCell(13,5).value="Vienības cena, EUR",d.mergeCells(13,9,13,12),d.getCell(13,9).value="Summa, EUR",d.getCell(14,5).value="Darbs",d.getCell(14,6).value="Materiāli",d.getCell(14,7).value="Mehānismi",d.getCell(14,8).value="Cena",d.getCell(14,9).value="Darbs",d.getCell(14,10).value="Materiāli",d.getCell(14,11).value="Mehānismi",d.getCell(14,12).value="Kopā",[13,14])){let t=d.getRow(e);for(let e=1;e<=12;e++){let l=t.getCell(e);l.font={...c,bold:!0},l.alignment={horizontal:"center",vertical:"middle",wrapText:!0},l.fill=b,l.border=h}t.height=22}let N=15,I=1,L=null,D=null,F=Array.from({length:12},()=>[]),T=(e,t)=>F[e-1].push(String(null!=t?t:"")),M=R.reduce((e,t)=>{var l;return(e[l=t.room]||(e[l]=[])).push(t),e},{});for(let e of Object.keys(M)){d.mergeCells(N,2,N,12);let t=d.getCell(N,2);for(let l of(t.value=e,t.fill=x,t.font={...c,bold:!0},t.alignment={wrapText:!0,vertical:"middle"},t.border={bottom:p},d.getRow(N).height=18,T(2,e),N++,M[e])){let e=d.getRow(N);e.getCell(1).value=I++,T(1,e.getCell(1).value),e.getCell(2).value=l.name,T(2,l.name),e.getCell(3).value=l.unit,T(3,l.unit),e.getCell(4).value=l.qty,T(4,l.qty);let t=u(l.labor),a=u(l.materials),i=u(l.mechanisms),n=t+a+i>0;for(let r of(e.getCell(5).value=n?t:u(l.unitPrice),T(5,e.getCell(5).value),e.getCell(6).value=n?a:0,T(6,e.getCell(6).value),e.getCell(7).value=n?i:0,T(7,e.getCell(7).value),e.getCell(8).value={formula:"ROUND(SUM(E".concat(N,":G").concat(N,"),2)")},T(8,""),e.getCell(9).value={formula:"ROUND(E".concat(N,"*D").concat(N,",2)")},T(9,""),e.getCell(10).value={formula:"ROUND(F".concat(N,"*D").concat(N,",2)")},T(10,""),e.getCell(11).value={formula:"ROUND(G".concat(N,"*D").concat(N,",2)")},T(11,""),e.getCell(12).value={formula:"ROUND(H".concat(N,"*D").concat(N,",2)")},T(12,""),e.getCell(4).numFmt="#,##0.00",[5,6,7,8,9,10,11,12]))e.getCell(r).numFmt=g;let r=(N-15)%2==1;for(let t=1;t<=12;t++){let l=e.getCell(t);l.border=h,l.font=c,l.alignment=2===t?{wrapText:!0,vertical:"middle"}:{vertical:"middle",horizontal:"right"},r&&(l.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF9FAFB"}})}null===L&&(L=N),D=N,N++}}let U=N+1;for(let e of(d.getCell("B".concat(U)).value="Kopā",d.getCell("I".concat(U)).value={formula:L?"SUM(I".concat(L,":I").concat(D,")"):"0"},d.getCell("J".concat(U)).value={formula:L?"SUM(J".concat(L,":J").concat(D,")"):"0"},d.getCell("K".concat(U)).value={formula:L?"SUM(K".concat(L,":K").concat(D,")"):"0"},d.getCell("L".concat(U)).value={formula:L?"SUM(L".concat(L,":L").concat(D,")"):"0"},[9,10,11,12]))d.getCell(U,e).numFmt=g;for(let e of(U+=2,d.getCell("B".concat(U)).value="Tiešās izmaksas kopā",d.getCell("I".concat(U)).value={formula:"I".concat(U-2)},d.getCell("J".concat(U)).value={formula:"J".concat(U-2)},d.getCell("K".concat(U)).value={formula:"K".concat(U-2)},d.getCell("L".concat(U)).value={formula:"L".concat(U-2)},[9,10,11,12]))d.getCell(U,e).numFmt=g;let A=U+5;d.getCell("B".concat(A)).value="PVN",d.getCell("C".concat(A)).value=.21,d.getCell("L".concat(A)).value={formula:"ROUND(L".concat(U,"*C").concat(A,",2)")},d.getCell("L".concat(A)).numFmt=g;let E=A+1;d.getCell("B".concat(E)).value="Pavisam kopā",d.getCell("L".concat(E)).value={formula:"ROUND(L".concat(U,"+L").concat(A,",2)")},d.getCell("L".concat(E)).numFmt=g,d.getCell("J9").value="Tāmes summa euro :",d.getCell("L9").value={formula:"L".concat(U)},d.getCell("L9").numFmt=g,d.getCell("J10").value="PVN 21%:",d.getCell("L10").value={formula:"L".concat(A)},d.getCell("L10").numFmt=g,d.getCell("J11").value="Pavisam kopā euro:",d.getCell("L11").value={formula:"L".concat(E)},d.getCell("L11").numFmt=g;let P=[6,56,12,10,14,14,14,14,16,16,16,18];for(let e=1;e<=12;e++){let t=Math.max(0,...F[e-1].map(e=>String(e).length));d.getColumn(e).width=Math.min(80,Math.max(P[e-1],Math.ceil(1.1*t)+2))}o.removeWorksheet(s.id),d.name="Tāme";let _=await o.xlsx.writeBuffer(),J=new Blob([_],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),O=URL.createObjectURL(J),K=document.createElement("a");K.href=O,K.download="Tame_Balta_".concat(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=e=>String(e).padStart(2,"0");return"".concat(e.getFullYear(),"-").concat(t(e.getMonth()+1),"-").concat(t(e.getDate()),"_").concat(t(e.getHours()),"-").concat(t(e.getMinutes()))}(),".xlsx"),document.body.appendChild(K),K.click(),K.remove(),URL.revokeObjectURL(O)}catch(e){console.error("Excel export error:",e),alert("Neizdevās izveidot Excel failu. Skaties konsolē kļūdu.")}}function em(e){let{label:t,children:l}=e;return(0,a.jsxs)("div",{style:{marginBottom:12},children:[(0,a.jsx)("div",{style:{fontWeight:600,marginBottom:6},children:t}),(0,a.jsx)("div",{children:l})]})}function eg(e){let{title:t,children:l}=e;return(0,a.jsxs)("div",{style:{background:"white",padding:16,borderRadius:12,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[(0,a.jsx)("div",{style:{fontSize:18,fontWeight:700,marginBottom:10},children:t}),l]})}let ep=Math.round((h-1)/11*100);return(0,a.jsx)("div",{style:{minHeight:"100vh",background:"#f7fafc",color:"#111827"},children:(0,a.jsxs)("div",{style:{maxWidth:1e3,margin:"0 auto",padding:16},children:[(0,a.jsx)("div",{style:{background:"white",padding:12,borderRadius:12,marginBottom:12},children:(0,a.jsx)(em,{label:"Lietas Nr.",children:(0,a.jsx)("input",{value:y,onChange:e=>C(e.target.value),placeholder:"piem., CLV1234567",style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8}})})}),(0,a.jsxs)("header",{style:{display:"flex",justifyContent:"space-between",gap:12,marginBottom:16},children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{fontSize:22,fontWeight:800},children:["Apskates forma – solis ",h,"/",12]}),(0,a.jsx)("div",{style:{fontSize:13,color:"#4b5563"},children:"Tāmētājs ievada tikai daudzumu. Cenas netiek rādītas formā un parādīsies tikai gala tāmē."})]}),(0,a.jsxs)("div",{style:{background:"white",padding:12,borderRadius:12,width:360},children:[(0,a.jsx)("div",{style:{fontWeight:600,marginBottom:6},children:"Tāmētāja profils (neobligāti)"}),(0,a.jsx)("input",{style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8,marginBottom:6},placeholder:"Vārds, Uzvārds",value:x,onChange:e=>v(e.target.value)}),(0,a.jsx)("input",{style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8},placeholder:"E-pasts",value:j,onChange:e=>f(e.target.value)})]})]}),(0,a.jsx)("div",{style:{height:8,background:"#e5e7eb",borderRadius:999,marginBottom:16},children:(0,a.jsx)("div",{style:{width:"".concat(ep,"%"),height:8,background:"#10b981",borderRadius:999}})}),1===h&&(0,a.jsx)(eg,{title:"1. Objekta adrese",children:(0,a.jsx)(em,{label:"Objekta adrese",children:(0,a.jsx)("input",{value:k,onChange:e=>w(e.target.value),placeholder:"Iela 1, Pilsēta",style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8}})})}),2===h&&(0,a.jsxs)(eg,{title:"2. Apdrošināšanas kompānija",children:[(0,a.jsx)(em,{label:"Izvēlies kompāniju",children:(0,a.jsx)("select",{value:S,onChange:e=>R(e.target.value),style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8,background:"white"},children:n.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})}),"Balta"===S&&(0,a.jsx)("div",{style:{fontSize:12,color:ea?"#b91c1c":"#065f46"},children:ea||(et.length?"Ielādēts BALTA cenrādis (".concat(et.length," pozīcijas)"):"Notiek BALTA cenrāža ielāde...")})]}),3===h&&(0,a.jsxs)(eg,{title:"3. Kur notika negadījums?",children:[(0,a.jsx)(em,{label:"Vieta",children:(0,a.jsxs)("select",{value:z,onChange:e=>N(e.target.value),style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8,background:"white"},children:[(0,a.jsx)("option",{value:"",children:"— Izvēlies —"}),r.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})}),"Dzīvojamā ēka"===z&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(em,{label:"3.1. Dzīvojamās ēkas tips",children:(0,a.jsxs)("select",{value:B,onChange:e=>I(e.target.value),style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8,background:"white"},children:[(0,a.jsx)("option",{value:"",children:"— Izvēlies —"}),o.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})}),"Cits"===B&&(0,a.jsx)(em,{label:"3.1.1. Norādi",children:(0,a.jsx)("input",{value:L,onChange:e=>D(e.target.value),placeholder:"NI tips",style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8}})})]})]}),4===h&&(0,a.jsxs)(eg,{title:"4. Kas notika ar nekustamo īpašumu?",children:[(0,a.jsx)(em,{label:"Notikuma veids",children:(0,a.jsxs)("select",{value:F,onChange:e=>T(e.target.value),style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8,background:"white"},children:[(0,a.jsx)("option",{value:"",children:"— Izvēlies —"}),s.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})}),"Cits"===F&&(0,a.jsx)(em,{label:"4.1. Norādi",children:(0,a.jsx)("input",{value:M,onChange:e=>U(e.target.value),placeholder:"Notikuma apraksts",style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8}})})]}),5===h&&(0,a.jsx)(eg,{title:"5. Elektrības traucējumi",children:(0,a.jsxs)(em,{label:"Elektrības traucējumi",children:[(0,a.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:8,marginRight:16},children:[(0,a.jsx)("input",{type:"radio",name:"el",checked:"Jā"===A,onChange:()=>E("Jā")})," Ir"]}),(0,a.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[(0,a.jsx)("input",{type:"radio",name:"el",checked:"Nē"===A,onChange:()=>E("Nē")})," Nav"]})]})}),6===h&&(0,a.jsx)(eg,{title:"6. Vai nepieciešama žāvēšana?",children:(0,a.jsx)(em,{label:"Žāvēšana",children:d.map(e=>(0,a.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:8,marginRight:16},children:[(0,a.jsx)("input",{type:"radio",name:"dry",checked:P===e,onChange:()=>_(e)})," ",e]},e))})}),7===h&&(0,a.jsx)(eg,{title:"7. Vai bojāts kopīpašums?",children:(0,a.jsx)(em,{label:"Kopīpašums",children:d.map(e=>(0,a.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:8,marginRight:16},children:[(0,a.jsx)("input",{type:"radio",name:"common",checked:J===e,onChange:()=>O(e)})," ",e]},e))})}),8===h&&(0,a.jsxs)(eg,{title:"8. Zaudējuma novērtējums pēc klienta vārdiem",children:[(0,a.jsx)(em,{label:"Vai ir zināma summa?",children:d.map(e=>(0,a.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:8,marginRight:16},children:[(0,a.jsx)("input",{type:"radio",name:"loss",checked:K===e,onChange:()=>W(e)})," ",e]},e))}),"Jā"===K&&(0,a.jsx)(em,{label:"Summa EUR",children:(0,a.jsx)("input",{type:"number",min:0,value:V,onChange:e=>q(e.target.value),placeholder:"€ summa",style:{width:200,border:"1px solid #e5e7eb",borderRadius:10,padding:8}})})]}),9===h&&(0,a.jsx)(eg,{title:"9. Izvēlies telpu/as, kas tika bojātas",children:(0,a.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(240px,1fr))",gap:12},children:c.map(e=>(0,a.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12},children:[(0,a.jsxs)("label",{style:{fontWeight:600,display:"flex",alignItems:"center",gap:8},children:[(0,a.jsx)("input",{type:"checkbox",checked:G[e].checked,onChange:t=>H({...G,[e]:{...G[e],checked:t.target.checked}})}),e]}),G[e].checked&&(0,a.jsxs)("div",{style:{marginTop:8},children:["Cits"===e&&(0,a.jsx)("input",{placeholder:"Telpas nosaukums",value:G[e].custom,onChange:t=>H({...G,[e]:{...G[e],custom:t.target.value}}),style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8,marginBottom:8}}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,a.jsx)("span",{children:"Daudzums:"}),(0,a.jsx)("input",{type:"number",min:1,value:G[e].count,onChange:t=>H({...G,[e]:{...G[e],count:Math.max(1,Number(t.target.value||1))}}),style:{width:90,border:"1px solid #e5e7eb",borderRadius:10,padding:6}})]})]})]},e))})}),10===h&&(0,a.jsxs)(eg,{title:"10. Izvēlētās telpas",children:[0===Y.length?(0,a.jsx)("div",{style:{color:"#6b7280"},children:"Nav izvēlētas telpas 9. solī."}):(0,a.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))",gap:12},children:Y.map(e=>{let t=(Z[e.id]||[]).filter(e=>e.itemId&&e.quantity).length,l=(e.id,[]);return(0,a.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#f9fafb"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:6},children:[(0,a.jsxs)("div",{style:{fontWeight:700},children:[e.type," ",e.index]}),(0,a.jsx)("button",{type:"button",onClick:()=>(function(e){let[t,l]=String(e).split("-"),a=parseInt(l,10)||1;Q(e=>{var l,i;let n={...e},r=(null==(l=G[t])?void 0:l.checked)?Number(null==(i=G[t])?void 0:i.count)||1:0;if(r<=0)return n;for(let e=a+1;e<=r;e++){let l="".concat(t,"-").concat(e),a="".concat(t,"-").concat(e-1);n[l]&&(n[a]=n[l])}return delete n["".concat(t,"-").concat(r)],n}),H(e=>{let l=e[t];if(!l)return e;let a=(Number(l.count)||1)-1,i={...e};return a<=0?i[t]={...l,checked:!1,count:1}:i[t]={...l,checked:!0,count:a},i}),ee(t=>t===e?null:t)})(e.id),title:"Dzēst telpu",style:{marginLeft:"auto",padding:"4px 8px",borderRadius:8,border:"1px solid #e5e7eb",background:"white"},children:"Dzēst"})]}),(0,a.jsxs)("div",{style:{fontSize:13,color:"#4b5563",marginBottom:8},children:["Pozīcijas: ",t]}),l.length>0&&(0,a.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6,marginBottom:8},children:l.map(e=>(0,a.jsx)("span",{style:{background:"#e5e7eb",borderRadius:999,padding:"4px 10px",fontSize:12},children:e},e))}),(0,a.jsx)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:(0,a.jsx)("button",{type:"button",onClick:()=>{ee(e.id),b(11)},style:{padding:"8px 12px",borderRadius:10,background:"#111827",color:"white",border:0},children:"Atvērt"})})]},e.id)})}),Y.length>0&&(0,a.jsxs)("div",{style:{marginTop:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsx)("button",{type:"button",onClick:()=>b(9),style:{padding:"10px 14px",borderRadius:10,border:"1px solid #e5e7eb",background:"white"},children:"+ Pievienot vēl telpu"}),Y.every(e=>(Z[e.id]||[]).some(e=>e.itemId&&e.quantity))&&(0,a.jsx)("button",{type:"button",onClick:eu,style:{padding:"12px 16px",borderRadius:12,background:"#059669",color:"white",border:0},children:"Viss pabeigts — izveidot tāmi"})]})]}),11===h&&$&&(0,a.jsxs)(eg,{title:"11. Pozīcijas un apjomi – ".concat(null==(e=Y.find(e=>e.id===$))?void 0:e.type," ").concat(null==(t=Y.find(e=>e.id===$))?void 0:t.index),children:[(0,a.jsx)(em,{label:"Piezīmes",children:(0,a.jsx)("input",{value:(null==(p=Y.find(e=>e.id===$))?void 0:p.note)||"",onChange:e=>{var t;return t=e.target.value,void X(e=>e.map(e=>e.id===$?{...e,note:t}:e))},placeholder:"Papildus informācija",style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8}})}),(0,a.jsx)("div",{style:{fontWeight:700,margin:"12px 0 6px"},children:"Pozīcijas un apjomi"}),(Z[$]||[{category:"",itemUid:"",itemId:"",itemName:"",quantity:"",unit:"",unit_price:null}]).map((e,t)=>(e.category&&et.filter(t=>t.category===e.category),(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1.1fr 2.2fr 1fr 0.8fr auto",gap:8,alignItems:"end",marginBottom:8},children:["// 1) Kategorija",(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontSize:13,marginBottom:4},children:"Kategorija"}),(0,a.jsxs)("select",{value:e.category||"",onChange:e=>{var l;return l=e.target.value,void Q(e=>{let a=[...e[$]||[]];return a[t]={...a[t],category:l,itemUid:"",itemId:"",itemName:"",unit:"",unit_price:null,labor:0,materials:0,mechanisms:0},{...e,[$]:a}})},style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8,background:"white"},children:[(0,a.jsx)("option",{value:"",children:"— visas —"}),en.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),"// 2) Pozīcija (filtrēta pēc kategorijas)",(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontSize:13,marginBottom:4},children:"Pozīcija"}),(0,a.jsxs)("select",{value:e.itemUid||e.itemId||"",onChange:e=>(function(e,t,l){let a=et.find(e=>e.uid===l||e.id===l);Q(l=>{let i=[...l[e]||[]];return a?i[t]={...i[t],category:a.category||i[t].category||"",itemUid:a.uid,itemId:a.id,itemName:a.name,unit:a.unit||"",unit_price:u(a.unit_price),labor:u(a.labor),materials:u(a.materials),mechanisms:u(a.mechanisms)}:i[t]={...i[t],itemUid:"",itemId:"",itemName:"",unit:"",unit_price:null,labor:0,materials:0,mechanisms:0},{...l,[e]:i}})})($,t,e.target.value),style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8,background:"white"},children:[(0,a.jsx)("option",{value:"",children:"— izvēlies pozīciju —"}),et.filter(t=>!e.category||t.category===e.category).map(e=>(0,a.jsxs)("option",{value:e.uid,children:[e.name," \xb7 ",e.unit||"—"]},e.uid))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontSize:13,marginBottom:4},children:"Mērv."}),(0,a.jsxs)("select",{value:m(e.unit)||"",onChange:e=>ed($,t,"unit",m(e.target.value)),style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8,background:"white"},children:[(0,a.jsx)("option",{value:"",children:"—"}),er.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontSize:13,marginBottom:4},children:"Daudz."}),(0,a.jsx)("input",{type:"number",min:0,step:"0.01",value:e.quantity,onChange:e=>ed($,t,"quantity",e.target.value),style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8},placeholder:"Skaitlis"})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",justifyContent:"flex-end"},children:[(0,a.jsx)("button",{type:"button",onClick:()=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Q(l=>({...l,[e]:[...l[e]||[],{category:t||"",itemId:"",itemName:"",quantity:"",unit:"",unit_price:null}]}))})($,e.category||""),style:{padding:"8px 12px",borderRadius:10,background:"#111827",color:"white",border:0},children:"+ Rinda"}),(0,a.jsx)("button",{type:"button",onClick:()=>{Q(e=>{let l=e[$]||[];return l.length<=1?e:{...e,[$]:l.filter((e,l)=>l!==t)}})},style:{padding:"8px 12px",borderRadius:10,border:"1px solid #e5e7eb",background:"white"},children:"Dzēst"}),(0,a.jsx)("button",{type:"button",onClick:()=>{ee(null),b(9)},style:{padding:"10px 14px",borderRadius:10,border:"1px solid #e5e7eb",background:"white",color:"#111827"},children:"+ Pievienot vēl telpu"})]})]},t))),(0,a.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:(0,a.jsx)("button",{type:"button",onClick:()=>{ee(null),b(10)},style:{padding:"10px 14px",borderRadius:10,background:"#111827",color:"white",border:0},children:"Saglabāt un atgriezties"})})]}),[1,2,3,4,5,6,7,8,9,12].includes(h)&&(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:16},children:[(0,a.jsx)("button",{type:"button",onClick:()=>b(e=>Math.max(1,e-1)),disabled:1===h,style:{padding:"10px 14px",borderRadius:10,border:"1px solid #e5e7eb",background:1===h?"#f3f4f6":"white",color:"#111827"},children:"← Atpakaļ"}),(0,a.jsx)("button",{type:"button",onClick:()=>b(e=>Math.min(12,e+1)),disabled:!ec||12===h,style:{padding:"10px 14px",borderRadius:10,background:ec&&12!==h?"#111827":"#9ca3af",color:"white",border:0},children:12===h?"Beigas":"Tālāk →"})]}),(0,a.jsxs)("div",{style:{background:"white",padding:16,borderRadius:12,marginTop:20},children:[(0,a.jsx)("div",{style:{fontWeight:700,marginBottom:8},children:"Saglabātās tāmēs (šajā pārlūkā)"}),0===eo.length?(0,a.jsx)("div",{style:{color:"#6b7280"},children:"Vēl nav saglabātu tāmju."}):(0,a.jsx)("div",{style:{overflowX:"auto"},children:(0,a.jsxs)("table",{style:{width:"100%",fontSize:14},children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:[(0,a.jsx)("th",{style:{padding:"8px 12px"},children:"Fails"}),(0,a.jsx)("th",{style:{padding:"8px 12px"},children:"Tāmētājs"}),(0,a.jsx)("th",{style:{padding:"8px 12px"},children:"Datums"})]})}),(0,a.jsx)("tbody",{children:eo.map(e=>(0,a.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[(0,a.jsx)("td",{style:{padding:"8px 12px",fontFamily:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace"},children:e.filename}),(0,a.jsx)("td",{style:{padding:"8px 12px"},children:e.estimator}),(0,a.jsx)("td",{style:{padding:"8px 12px"},children:new Date(e.createdAtISO).toLocaleString()})]},e.id))})]})})]}),(0,a.jsxs)("footer",{style:{paddingBottom:40,marginTop:12,fontSize:12,color:"#6b7280"},children:["Piezīme: cenrādis ielādējas no ",(0,a.jsx)("code",{children:"public/prices/balta.json"})," (Balta 27.08.2024). Cenas netiek rādītas formā; tās parādās tikai gala tāmē."]})]})})}}}]);