"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[857],{4857:(e,t,l)=>{l.r(t),l.d(t,{default:()=>_});var a=l(7876),i=l(4232);let n=["Swedbank","Gjensidige","Compensa","IF","BTA","Balta"],r=["Komerctelpa","Dzīvojamā ēka"],o=["Privātmāja","Daudzdzīvokļu māja","Rindu māja","Cits"],s=["CTA","Plūdi","Uguns","Koks","Cits"],c=["Jā","Nē"],u=["labor","darbs"],d=["materials","materiāli","materiali","materjali","materiālu izmaksas","materialu izmaksas"],m=["mechanisms","mehānismi","mehanismi","mehānismu","meh","mehānismu izmaksas","meh izmaksas","mehizmaksas"],p=["unit_price","unitprice","vienības cena","vienibas cena","cena"],g=["Virtuve","Guļamistaba","Koridors","Katla telpa","Dzīvojamā istaba","Vannas istaba","Tualete","Garderobe","Cits"];function h(e){if(!e)return"";let t=String(e).trim().toLowerCase().replace("\xb2","2").replace("\xa0"," ").replace(/\s{2,}/g," ");return["gb.","gab.","gab"].includes(t)?"gab":["m2","m 2","m^2"].includes(t)?"m2":["m3","m 3","m^3"].includes(t)?"m3":"m"===t?"m":["kpl","kpl."].includes(t)?"kpl":"diena"===t?"diena":"c/h"===t?"c/h":["obj.","obj"].includes(t)?"obj":/^\d+\s*gb\.$/.test(t)?"gab":t}function f(e){if(null==e||""===e)return 0;let t=parseFloat(String(e).replace(/\s+/g,"").replace(",","."));return Number.isFinite(t)?t:0}function b(e,t){if(!e||"object"!=typeof e)return 0;let l=e=>String(null!=e?e:"").toLowerCase().normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"").trim(),a=Object.entries(e).map(e=>{let[t,a]=e;return[l(t),a]});for(let e of t){let t=l(e),i=a.find(e=>{let[l]=e;return l===t});if(i){let e=f(i[1]);return Number.isFinite(e)?e:0}}return 0}let v=e=>String(null!=e?e:"").toLowerCase().normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(RegExp("[^\\p{L}\\p{N}]+","gu")," ").replace(/\s+/g," ").trim();function x(e){return String(null!=e?e:"").normalize("NFD").replace(RegExp("\\p{Diacritic}","gu"),"").replace(/\s+/g," ").trim().toLowerCase()}let C=(0,i.useCallback)((e,t)=>{let l=v(e),a=v(t),i="".concat(a,"|").concat(l);if(k.has(i))return k.get(i);let n=y.get(l);if(Array.isArray(n)&&n.length)return n[0];for(let[e,t]of k.entries()){let[i,n]=e.split("|");if(i===a&&n.includes(l))return t}return null},[y,k]),[y,j]=(0,i.useState)(new Map),[k,w]=(0,i.useState)(new Map);(0,i.useMemo)(()=>{let e=new Map;for(let t of priceCatalog)e.set(String(t.id),t);return e},[priceCatalog]),(0,i.useMemo)(()=>{let e=new Map;for(let t of priceCatalog){let l=x(t.name);l&&e.set(l,t)}return e},[priceCatalog]),(0,i.useMemo)(()=>{let e=new Map;for(let t of priceCatalog){let l="".concat(x(t.category),"||").concat(x(t.name));l&&e.set(l,t)}return e},[priceCatalog]);let S=["m2","m3","m","gab","kpl","diena","obj","c/h"],N=e=>!0===e||1===e||"1"===e||"string"==typeof e&&["true","yes","y","jā"].includes(e.trim().toLowerCase()),z=e=>N(e.is_child)||N(e.child)||!!e.parent_uid||!!e.parentUid||!!e.parent_id||!!e.parentId||!!e.parent||!!e.parent_name||!!e.parentName||!!e.childOf||!!e.parentKey||!!e.parent_key;function R(e,t){var l,a,i,n,r,o;let s=Number(null!=(l=null==e?void 0:e.labor)?l:0)||0,c=Number(null!=(a=null==e?void 0:e.mechanisms)?a:0)||0,u=Number(null!=(i=null==e?void 0:e.unit_price)?i:0)||0,d=Number(null!=(n=null==e?void 0:e.materials)?n:s||c?0:u)||0;return{name:(null==e?void 0:e.name)||"",unit:h((null==e?void 0:e.unit)||t||""),coeff:Number(null!=(o=null!=(r=null==e?void 0:e.coeff)?r:null==e?void 0:e.multiplier)?o:1)||1,labor:s,materials:d,mechanisms:c,unit_price_raw:u}}let L=i.memo(function(e){let{label:t,children:l}=e;return(0,a.jsxs)("div",{style:{marginBottom:12},children:[(0,a.jsx)("div",{style:{fontWeight:600,marginBottom:6},children:t}),(0,a.jsx)("div",{children:l})]})}),B=i.memo(function(e){let{title:t,children:l}=e;return(0,a.jsxs)("div",{style:{background:"white",padding:16,borderRadius:12,boxShadow:"0 1px 4px rgba(0,0,0,0.06)"},children:[(0,a.jsx)("div",{style:{fontSize:18,fontWeight:700,marginBottom:10},children:t}),l]})});function _(){var e,t,y,k;let[_,A]=(0,i.useState)(1),D=(0,i.useMemo)(()=>{var e;let t=!!(null==(e=window.__NEXT_DATA__)?void 0:e.assetPrefix),l=window.location.pathname.startsWith("/eksperti");return t||l?"/eksperti":""},[]),[I,F]=(0,i.useState)(""),[M,T]=(0,i.useState)(""),[U,E]=(0,i.useState)(""),[O,J]=(0,i.useState)(""),[K,P]=(0,i.useState)("Balta"),[V,W]=(0,i.useState)(""),[q,G]=(0,i.useState)(""),[H,X]=(0,i.useState)(""),[Y,Z]=(0,i.useState)(""),[$,Q]=(0,i.useState)(""),[ee,et]=(0,i.useState)("Nē"),[el,ea]=(0,i.useState)("Nē"),[ei,en]=(0,i.useState)("Nē"),[er,eo]=(0,i.useState)("Nē"),[es,ec]=(0,i.useState)(""),[eu,ed]=(0,i.useState)(g.reduce((e,t)=>(e[t]={checked:!1,count:1,custom:""},e),{})),[em,ep]=(0,i.useState)([]),[eg,eh]=(0,i.useState)({}),[ef,eb]=(0,i.useState)(null),[ev,ex]=(0,i.useState)([]),[eC,ey]=(0,i.useState)(""),[ej,ek]=(0,i.useState)(new Map),[ew,eS]=(0,i.useState)({});(0,i.useEffect)(()=>{let e=!1;return(async()=>{try{let t=await fetch("".concat(D,"/prices/child_hints.json"),{cache:"no-store"});if(!t.ok)return;let l=await t.json();if(e||!l||"object"!=typeof l)return;let a={},i=e=>String(null!=e?e:"").trim().toLowerCase();for(let[e,t]of Object.entries(l))a[i(e)]=Array.isArray(t)?t:[];eS(a)}catch(e){}})(),()=>{e=!0}},[D]),(0,i.useEffect)(()=>{if("Balta"!==K){ex([]),ek(new Map);return}ey(""),(async()=>{try{let e,t=async e=>{let t=await fetch(e,{cache:"no-store"});if(!t.ok)throw Error("".concat(t.status," ").concat(t.statusText));let l=await t.json();return Array.isArray(l)?l:Array.isArray(l.items)?l.items:[]};try{e=await t("".concat(D,"/prices/balta.v2.json"))}catch(l){e=await t("".concat(D,"/prices/balta.json"))}let l=[],a=[],i=[];e.forEach((e,t)=>{var n,r,o;let s=(e.category||"").trim(),c=(e.subcategory||e.subcat||e.group||e.grupa||e["apakškategorija"]||"").trim(),g=String(null!=(n=e.id)?n:t),v=(e.name||"").trim(),x=[s,c,g,v].join("::"),C=e.parent_uid||e.parentUid||e.parent_id||e.parentId||e.parent||e.parent_name||e.parentName||e.childOf||null,y=N(e.is_child)||!!C,j={id:g,uid:x,name:v,category:s,subcategory:c,unit:h(e.unit),unit_price:b(e,p),labor:b(e,u),materials:b(e,d),mechanisms:b(e,m),is_child:y,parent_uid:C||null};if(y){let t={...j,coeff:f(null!=(o=null!=(r=e.coeff)?r:e.multiplier)?o:1)||1};a.push(t),i.push(t)}else{let t={...j,is_child:!1,parent_uid:null};l.push(t),i.push(t);let n=Array.isArray(e.children)&&e.children||Array.isArray(e.komponentes)&&e.komponentes||Array.isArray(e.apaks)&&e.apaks||[];n.length&&(t.children=[],n.forEach((l,n)=>{var r,o;let v=(l.name||l.title||"").trim();if(!v)return;let C={id:"".concat(g,"-c").concat(n),uid:[s,c,"".concat(g,"-c").concat(n),v].join("::"),name:v,category:s,subcategory:c,unit:h(l.unit||e.unit),unit_price:b(l,p),labor:b(l,u),materials:b(l,d),mechanisms:b(l,m),is_child:!0,parent_uid:x,coeff:f(null!=(o=null!=(r=l.coeff)?r:l.multiplier)?o:1)||1};a.push(C),i.push(C),t.children.push({name:C.name,unit:C.unit,coeff:C.coeff||1,labor:C.labor||0,materials:C.materials||0,mechanisms:C.mechanisms||0})}))}});let n=new Map,r=null;for(let e of i){if(!e.is_child){r=e;continue}if(r&&e.category===r.category&&e.subcategory===r.subcategory){let t=n.get(r.uid)||[],l=R(e,r.unit);t.some(e=>x(e.name)===x(l.name)&&h(e.unit)===h(l.unit))||t.push(l),n.set(r.uid,t)}}let o=[...l,...a],s=new Map,c=new Map;for(let e of o){let t=v(e.name),l=v(e.category);s.has(t)||s.set(t,[]),s.get(t).push(e),c.set("".concat(l,"|").concat(t),e)}for(let e of(ex(o),j(s),w(c),ek(n),ex([...l,...a]),["impregnēta koka brusa","montāžas elementi","Kokmateriāla apstrāde ar antipirēnu"])){let t=[...l,...a].find(t=>t&&t.name&&t.name.toLowerCase()===e.toLowerCase());t?console.log("DEBUG row:",t.name,{labor:t.labor,materials:t.materials,mechanisms:t.mechanisms,unit_price:t.unit_price,unit:t.unit}):console.warn("DEBUG missing row for",e)}ek(n)}catch(e){ey("Neizdevās ielādēt BALTA cenas: ".concat(e.message))}})()},[K,D]);let eN=(0,i.useCallback)(e=>{if(!e)return[];let t=[],l=new Set,a=(e,a)=>{let i=R(e,a),n="".concat(v(null==i?void 0:i.name),"::").concat(h((null==i?void 0:i.unit)||""));i.name&&!l.has(n)&&(l.add(n),t.push(i))};if(Array.isArray(e.children)&&e.children.length)for(let t of e.children)a(t,e.unit);for(let t of ev)z(t)&&function(e,t){let l=new Set([t.uid,t.id,t.name,"".concat(t.category,"::").concat(t.name)].map(x).filter(Boolean));return[e.parent_uid,e.parentUid,e.parent_id,e.parentId,e.parent,e.parent_name,e.parentName,e.childOf,e.parent_key,e.parentKey].map(x).filter(Boolean).some(e=>l.has(e))}(t,e)&&a(t,e.unit);let i=ej.get(e.uid);if(Array.isArray(i)&&i.length)for(let t of i)a(t,e.unit);let n=ew[v(e.name)];if(Array.isArray(n))for(let t of n){let l="string"==typeof t?t:null==t?void 0:t.name;if(!l)continue;let i=Number("object"==typeof t&&(null==t?void 0:t.coeff)?t.coeff:1)||1,n="object"==typeof t&&(null==t?void 0:t.unit)?t.unit:void 0,r=C(l,e.category)||function(e,t,l){let a=v(e),i=v(t),n=l.find(e=>v(e.name)===a&&v(e.category)===i);return n||(n=l.find(e=>v(e.name)===a))||(n=l.find(e=>v(e.category)===i&&v(e.name).includes(a)))?n:(n=l.find(e=>v(e.name).includes(a)))||null}(l,e.category,ev);a(r?{...r,unit:n||r.unit||e.unit,coeff:i,labor:b(r,["labor","darbs"]),materials:b(r,["materials","materiāli","materiali","materjali"]),mechanisms:b(r,["mechanisms","mehānismi","mehanismi","mehānismu","meh"]),unit_price:b(r,["unit_price","unitprice","vienības cena","vienibas cena","cena"])}:{name:l,unit:n||e.unit,coeff:i,labor:0,materials:0,mechanisms:0,unit_price:0},e.unit)}return t},[ev,ew,ej,C]),ez=(0,i.useMemo)(()=>Array.from(new Set(ev.map(e=>e.category).filter(Boolean))),[ev]),eR=(0,i.useMemo)(()=>{let e=new Set(S);return ev.forEach(t=>t.unit&&e.add(h(t.unit))),Array.from(e)},[ev]),[eL,eB]=(0,i.useState)([]);function e_(e,t,l,a){eh(i=>{let n=[...i[e]||[]],r={...n[t],[l]:a};return n[t]=r,{...i,[e]:n}})}(0,i.useEffect)(()=>eB(function(){try{let e=localStorage.getItem("tames_profils_saglabatie");return e?JSON.parse(e):[]}catch(e){return[]}}()),[]),(0,i.useEffect)(()=>{let e=[];Object.entries(eu).forEach(t=>{let[l,a]=t;if(!a.checked)return;let i=Math.max(1,Number(a.count)||1);for(let t=1;t<=i;t++){let i="".concat(l,"-").concat(t),n=em.find(e=>e.id===i);e.push({id:i,type:"Cits"===l?a.custom||"Cits":l,index:t,note:(null==n?void 0:n.note)||""})}}),ep(e),eh(t=>{let l={};return e.forEach(e=>{l[e.id]=t[e.id]||[{category:"",itemUid:"",itemId:"",itemName:"",quantity:"",unit:"",unit_price:null}]}),l})},[eu]);let eA=(0,i.useMemo)(()=>{switch(_){case 1:return!!O.trim();case 2:return!!K;case 3:return!!V&&("Dzīvojamā ēka"!==V||!!q);case 4:return!!Y&&("Cits"!==Y||!!$.trim());case 5:return["Jā","Nē"].includes(ee);case 6:return["Jā","Nē"].includes(el);case 7:return["Jā","Nē"].includes(ei);case 8:return"Nē"===er||"Jā"===er&&!!es&&Number(es)>=0;case 9:return Object.values(eu).some(e=>e.checked);default:return!0}},[_,O,K,V,q,Y,$,ee,el,ei,er,es,eu]);async function eD(){try{let t=e=>String(e).padStart(2,"0"),a=await l.e(22).then(l.t.bind(l,1980,23)),i=(null==a?void 0:a.default)||a,n="".concat(D,"/templates/balta_template.xlsx"),r=await fetch(n);if(!r.ok)return void alert("Neizdevās ielādēt ".concat(n,". Pārliecinies, ka fails ir public/templates/balta_template.xlsx"));let o=await r.arrayBuffer(),s=new i.Workbook;await s.xlsx.load(o);let c=s.getWorksheet("Tāme")||s.worksheets[0],u=s.addWorksheet("Tāme (izvade)",{views:[{showGridLines:!1}]}),d={name:"Calibri",size:11},m="#,##0.00",p={style:"thin"},g={top:p,left:p,bottom:p,right:p},b={type:"pattern",pattern:"solid",fgColor:{argb:"FFF3F6FD"}},v={type:"pattern",pattern:"solid",fgColor:{argb:"FFEFEFEF"}},x=new Date,C="".concat(x.getFullYear()).concat(t(x.getMonth()+1)).concat(t(x.getDate())),y="Balta"===K?"B-".concat(C):C,j="Balta"===K?"LOKĀLĀ TĀME NR.".concat(y):"TĀMES NR.: ".concat(y),k=x.toLocaleDateString("lv-LV",{year:"numeric",month:"long",day:"numeric"});u.getCell("A1").value="Pasūtītājs: ".concat(K||"Balta"),u.getCell("A2").value="Objekts: ".concat(V||"").concat(q?" – "+q:""),u.getCell("A3").value="Objekta adrese: ".concat(O||""),u.getCell("A8").value="Rīga, ".concat(k),u.getCell("A9").value="Pamatojums: apdrošināšanas lieta Nr. ".concat(U||"—"),u.getCell("J1").value="LV GROUP SIA",u.getCell("J2").value="Reģ. Nr.: LV40003216553",u.getCell("J3").value="Banka: Luminor",u.getCell("J4").value="Konts: LV12RIKO0002012345678",u.mergeCells(6,2,6,12);let w=u.getCell(6,2);w.value=j,w.font={...d,size:16,bold:!0},w.alignment={horizontal:"center",vertical:"middle"};let S=[];if(em.forEach(e=>{(eg[e.id]||[]).forEach(t=>{var l,a,i,n,r,o,s,c,u,d,m,p,g,b;let v=f(t.quantity);if(!v)return;let x=ev.find(e=>e.uid===t.itemUid)||ev.find(e=>e.id===t.itemId);if(!x)return;let C=h(t.unit||x.unit||""),y=f(null!=(a=null!=(l=t.labor)?l:x.labor)?a:0),j=f(null!=(n=null!=(i=t.materials)?i:x.materials)?n:0),k=f(null!=(o=null!=(r=t.mechanisms)?r:x.mechanisms)?o:0),w=y+j+k||f(null!=(c=null!=(s=t.unit_price)?s:x.unit_price)?c:0);for(let l of(S.push({isChild:!1,room:"".concat(e.type," ").concat(e.index),name:t.itemName||x.name||"",unit:C,qty:v,labor:y,materials:j,mechanisms:k,unitPrice:w}),eN(x))){let t=f(null!=(u=l.coeff)?u:1)*v,a=f(null!=(d=l.labor)?d:0),i=f(null!=(m=l.materials)?m:0),n=f(null!=(p=l.mechanisms)?p:0),r=a+i+n||f(null!=(b=null!=(g=l.unit_price)?g:l.unit_price_raw)?b:0);S.push({isChild:!0,room:"".concat(e.type," ").concat(e.index),name:l.name||"",unit:h(l.unit||C),qty:t,labor:a,materials:i,mechanisms:n,unitPrice:r})}})}),!S.length)return void alert("Nav nevienas pozīcijas ar daudzumu.");for(let e of(u.getCell(13,1).value="Nr.",u.getCell(13,2).value="Darbu nosaukums",u.getCell(13,3).value="Mērv.",u.getCell(13,4).value="Daudz.",u.mergeCells(13,5,13,8),u.getCell(13,5).value="Vienības cena, EUR",u.mergeCells(13,9,13,12),u.getCell(13,9).value="Summa, EUR",u.getCell(14,5).value="Darbs",u.getCell(14,6).value="Materiāli",u.getCell(14,7).value="Mehānismi",u.getCell(14,8).value="Cena",u.getCell(14,9).value="Darbs",u.getCell(14,10).value="Materiāli",u.getCell(14,11).value="Mehānismi",u.getCell(14,12).value="Kopā",[13,14])){let t=u.getRow(e);for(let e=1;e<=12;e++){let l=t.getCell(e);l.font={...d,bold:!0},l.alignment={horizontal:"center",vertical:"middle",wrapText:!0},l.fill=v,l.border=g}t.height=22}let N=15,z=1,R=null,L=null,B=new Map;for(let[e,t]of(S.forEach(e=>{B.has(e.room)||B.set(e.room,[]),B.get(e.room).push(e)}),B.entries())){u.mergeCells(N,2,N,12);let l=u.getCell(N,2);for(let a of(l.value=e,l.fill=b,l.font={...d,bold:!0},l.alignment={wrapText:!0,vertical:"middle"},l.border={bottom:p},u.getRow(N).height=18,N++,t)){let e=u.getRow(N);e.getCell(1).value=a.isChild?"":z++,e.getCell(2).value=a.isChild?"    ".concat(a.name):a.name,e.getCell(3).value=a.unit,e.getCell(4).value=a.qty;let t=Number(a.labor||0),l=Number(a.materials||0),i=Number(a.mechanisms||0);if(t+l+i>0)u.getCell(N,5).value=t,u.getCell(N,6).value=l,u.getCell(N,7).value=i;else{let e=Number(a.unitPrice||0);u.getCell(N,5).value=0,u.getCell(N,6).value=e,u.getCell(N,7).value=0}for(let t of(u.getCell(N,8).value={formula:"ROUND(SUM(E".concat(N,":G").concat(N,"),2)")},u.getCell(N,9).value={formula:"ROUND(E".concat(N,"*D").concat(N,",2)")},u.getCell(N,10).value={formula:"ROUND(F".concat(N,"*D").concat(N,",2)")},u.getCell(N,11).value={formula:"ROUND(G".concat(N,"*D").concat(N,",2)")},u.getCell(N,12).value={formula:"ROUND(H".concat(N,"*D").concat(N,",2)")},e.getCell(4).numFmt="#,##0.00",[5,6,7,8,9,10,11,12]))e.getCell(t).numFmt=m;let n=(N-15)%2==1;for(let t=1;t<=12;t++){let l=e.getCell(t);n&&(l.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF9FAFB"}}),l.border=g,l.font={...d,italic:!!a.isChild},l.alignment=2===t?{wrapText:!0,vertical:"middle"}:{vertical:"middle",horizontal:"right"}}null===R&&(R=N),L=N,N++}}let _=e=>{u.getCell(e).font={...d,bold:!0}},A=N+1;for(let e of(u.getCell("B".concat(A)).value="Kopā",u.getCell("I".concat(A)).value={formula:R?"SUM(I".concat(R,":I").concat(L,")"):"0"},u.getCell("J".concat(A)).value={formula:R?"SUM(J".concat(R,":J").concat(L,")"):"0"},u.getCell("K".concat(A)).value={formula:R?"SUM(K".concat(R,":K").concat(L,")"):"0"},u.getCell("L".concat(A)).value={formula:R?"SUM(L".concat(R,":L").concat(L,")"):"0"},[9,10,11,12]))u.getCell(A,e).numFmt=m;_("B".concat(A));let I=A+1;u.getCell("B".concat(I)).value="Materiālu, grunts apmaiņas un būvgružu transporta izdevumi",u.getCell("C".concat(I)).value=.07,u.getCell("J".concat(I)).value={formula:"ROUND(J".concat(A,"*C").concat(I,",2)")},u.getCell("L".concat(I)).value={formula:"J".concat(I)},u.getCell("J".concat(I)).numFmt=m,u.getCell("L".concat(I)).numFmt=m;let F=I+1;for(let e of(u.getCell("B".concat(F)).value="Tiešās izmaksas kopā",u.getCell("I".concat(F)).value={formula:"I".concat(A)},u.getCell("J".concat(F)).value={formula:"ROUND(J".concat(A,"+J").concat(I,",2)")},u.getCell("K".concat(F)).value={formula:"K".concat(A)},u.getCell("L".concat(F)).value={formula:"ROUND(I".concat(F,"+J").concat(F,"+K").concat(F,",2)")},[9,10,11,12]))u.getCell(F,e).numFmt=m;_("B".concat(F));let M=F+1;u.getCell("B".concat(M)).value="Virsizdevumi",u.getCell("C".concat(M)).value=.09,u.getCell("L".concat(M)).value={formula:"ROUND(L".concat(F,"*C").concat(M,",2)")},u.getCell("L".concat(M)).numFmt=m;let T=M+1;u.getCell("B".concat(T)).value="Peļņa",u.getCell("C".concat(T)).value=.07,u.getCell("L".concat(T)).value={formula:"ROUND(L".concat(F,"*C").concat(T,",2)")},u.getCell("L".concat(T)).numFmt=m;let E=T+1;u.getCell("B".concat(E)).value="Darba devēja sociālais nodoklis",u.getCell("C".concat(E)).value=.2359,u.getCell("I".concat(E)).value={formula:"ROUND(I".concat(A,"*C").concat(E,",2)")},u.getCell("L".concat(E)).value={formula:"I".concat(E)},u.getCell("I".concat(E)).numFmt=m,u.getCell("L".concat(E)).numFmt=m;let J=E+1;u.getCell("B".concat(J)).value="Kopējās izmaksas",u.getCell("L".concat(J)).value={formula:"ROUND(L".concat(F,"+L").concat(M,"+L").concat(T,"+L").concat(E,",2)")},u.getCell("L".concat(J)).numFmt=m,_("B".concat(J)),_("L".concat(J));let P=J+1;u.getCell("B".concat(P)).value="PVN",u.getCell("C".concat(P)).value=.21,u.getCell("L".concat(P)).value={formula:"ROUND(L".concat(J,"*C").concat(P,",2)")},u.getCell("L".concat(P)).numFmt=m;let W=P+1;for(let t of(u.getCell("B".concat(W)).value="Pavisam kopā",u.getCell("L".concat(W)).value={formula:"ROUND(L".concat(J,"+L").concat(P,",2)")},u.getCell("L".concat(W)).numFmt=m,_("B".concat(W)),_("L".concat(W)),u.getCell("J9").value="Tāmes summa euro :",u.getCell("L9").value={formula:"L".concat(J)},u.getCell("L9").numFmt=m,u.getCell("J10").value="PVN 21%:",u.getCell("L10").value={formula:"L".concat(P)},u.getCell("L10").numFmt=m,u.getCell("J11").value="Pavisam kopā euro:",u.getCell("L11").value={formula:"L".concat(W)},u.getCell("L11").numFmt=m,[A,I,F,M,T,E,J,P,W]))for(let l=1;l<=12;l++){var e;let a=u.getCell(t,l);a.border=g,a.font={...d,bold:(null==(e=a.font)?void 0:e.bold)||!1},a.alignment=2===l?{wrapText:!0,vertical:"middle"}:{vertical:"middle",horizontal:"right"}}let G=W+3;u.getCell("B".concat(G)).value="Piezīmes:",u.getCell("B".concat(G)).font={...d,bold:!0},u.mergeCells(G,2,G,12);let H=G+1;for(let e of["1. Tāmes derīguma termiņš – 1 mēnesis.","2. Tāme sastādīta provizoriski, atbilstoši bojātā īpašuma apskates protokolam un bildēm.","3. Iespējami slēpti defekti, kuri atklāsies remontdarbu laikā.","4. Tāme ir sagatavota elektroniski un ir autorizēta ar Nr.".concat(y,".")]){u.mergeCells(H,2,H,12);let t=u.getCell(H,2);t.value=e,t.font=d,t.alignment={wrapText:!0,vertical:"top"},H++}for(let e of em.map(e=>(e.note||"").trim()).filter(Boolean)){u.mergeCells(H,2,H,12);let t=u.getCell(H,2);t.value=e,t.font=d,t.alignment={wrapText:!0,vertical:"top"},H++}let X=H+2;u.mergeCells(X,2,X,6),u.getCell(X,2).value="SASTĀDĪJA:",u.getCell(X,2).font={...d,bold:!0},u.getCell(X+1,2).value="Būvkomersanta Nr.:",u.mergeCells(X+1,3,X+1,6),u.getCell(X+2,2).value="Vārds, uzvārds:",u.mergeCells(X+2,3,X+2,6),u.getCell(X+3,2).value="sert. nr.:",u.mergeCells(X+3,3,X+3,6);let Y="Balta"===K?"AAS BALTA":K||"";u.mergeCells(X,9,X,12),u.getCell(X,9).value="SASKAŅOTS:",u.getCell(X,9).font={...d,bold:!0},u.mergeCells(X+1,9,X+1,12),u.getCell(X+1,9).value=Y,u.mergeCells(X+2,9,X+2,12),u.getCell(X+2,9).value="";let Z=[6,56,12,10,14,14,14,14,16,16,16,18];for(let e=1;e<=12;e++)u.getColumn(e).width=Z[e-1];s.removeWorksheet(c.id),u.name="Tāme";let $=await s.xlsx.writeBuffer(),Q=new Blob([$],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),ee=URL.createObjectURL(Q),et=document.createElement("a");et.href=ee,et.download="Tame_Balta_".concat(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=e=>String(e).padStart(2,"0");return"".concat(e.getFullYear(),"-").concat(t(e.getMonth()+1),"-").concat(t(e.getDate()),"_").concat(t(e.getHours()),"-").concat(t(e.getMinutes()))}(),".xlsx"),document.body.appendChild(et),et.click(),et.remove(),URL.revokeObjectURL(ee)}catch(e){console.error("Excel export error:",e),alert("Neizdevās izveidot Excel failu. Skaties konsolē kļūdu.")}}let eI=(0,i.useCallback)(e=>t=>e(t.target.value),[]),eF=(0,i.useCallback)(e=>t=>e(t.target.value),[]),eM=Math.round((_-1)/11*100);return(0,a.jsx)("div",{style:{minHeight:"100vh",background:"#f7fafc",color:"#111827"},children:(0,a.jsxs)("div",{style:{maxWidth:1e3,margin:"0 auto",padding:16},children:[(0,a.jsx)("div",{style:{background:"white",padding:12,borderRadius:12,marginBottom:12},children:(0,a.jsx)(L,{label:"Lietas Nr.",children:(0,a.jsx)("input",{value:null!=U?U:"",onChange:eI(E),placeholder:"piem., CLV1234567",autoComplete:"off",spellCheck:!1,style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8}})})}),(0,a.jsxs)("header",{style:{display:"flex",justifyContent:"space-between",gap:12,marginBottom:16},children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{fontSize:22,fontWeight:800},children:["Apskates forma – solis ",_,"/",12]}),(0,a.jsx)("div",{style:{fontSize:13,color:"#4b5563"},children:"Tāmētājs ievada tikai daudzumu. Cenas netiek rādītas formā un parādīsies tikai gala tāmē."})]}),(0,a.jsxs)("div",{style:{background:"white",padding:12,borderRadius:12,width:360},children:[(0,a.jsx)("div",{style:{fontWeight:600,marginBottom:6},children:"Tāmētāja profils (neobligāti)"}),(0,a.jsx)("input",{value:null!=I?I:"",onChange:eI(F),placeholder:"Vārds, Uzvārds",autoComplete:"off",style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8,marginBottom:6}}),(0,a.jsx)("input",{value:null!=M?M:"",onChange:eI(T),placeholder:"E-pasts",autoComplete:"off",style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8}})]})]}),(0,a.jsx)("div",{style:{height:8,background:"#e5e7eb",borderRadius:999,marginBottom:16},children:(0,a.jsx)("div",{style:{width:"".concat(eM,"%"),height:8,background:"#10b981",borderRadius:999}})}),1===_&&(0,a.jsx)(B,{title:"1. Objekta adrese",children:(0,a.jsx)(L,{label:"Objekta adrese",children:(0,a.jsx)("input",{value:null!=O?O:"",onChange:eI(J),placeholder:"Iela 1, Pilsēta",autoComplete:"off",spellCheck:!1,style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8}})})}),2===_&&(0,a.jsxs)(B,{title:"2. Apdrošināšanas kompānija",children:[(0,a.jsx)(L,{label:"Izvēlies kompāniju",children:(0,a.jsx)("select",{value:K,onChange:e=>P(e.target.value),style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8,background:"white"},children:n.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})}),"Balta"===K&&(0,a.jsx)("div",{style:{fontSize:12,color:eC?"#b91c1c":"#065f46"},children:eC||(ev.length?"Ielādēts BALTA cenrādis (".concat(ev.length," pozīcijas)"):"Notiek BALTA cenrāža ielāde...")})]}),3===_&&(0,a.jsxs)(B,{title:"3. Kur notika negadījums?",children:[(0,a.jsx)(L,{label:"Vieta",children:(0,a.jsxs)("select",{value:V,onChange:e=>W(e.target.value),style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8,background:"white"},children:[(0,a.jsx)("option",{value:"",children:"— Izvēlies —"}),r.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})}),"Dzīvojamā ēka"===V&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(L,{label:"3.1. Dzīvojamās ēkas tips",children:(0,a.jsxs)("select",{value:q,onChange:e=>G(e.target.value),style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8,background:"white"},children:[(0,a.jsx)("option",{value:"",children:"— Izvēlies —"}),o.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})}),"Cits"===q&&(0,a.jsx)(L,{label:"3.1.1. Norādi",children:(0,a.jsx)("input",{value:null!=H?H:"",onChange:eI(X),placeholder:"NI tips",autoComplete:"off",style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8}})})]})]}),4===_&&(0,a.jsxs)(B,{title:"4. Kas notika ar nekustamo īpašumu?",children:[(0,a.jsx)(L,{label:"Notikuma veids",children:(0,a.jsxs)("select",{value:Y,onChange:e=>Z(e.target.value),style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8,background:"white"},children:[(0,a.jsx)("option",{value:"",children:"— Izvēlies —"}),s.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})}),"Cits"===Y&&(0,a.jsx)(L,{label:"4.1. Norādi",children:(0,a.jsx)("input",{value:null!=$?$:"",onChange:eI(Q),placeholder:"Notikuma apraksts",autoComplete:"off",style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8}})})]}),5===_&&(0,a.jsx)(B,{title:"5. Elektrības traucējumi",children:(0,a.jsxs)(L,{label:"Elektrības traucējumi",children:[(0,a.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:8,marginRight:16},children:[(0,a.jsx)("input",{type:"radio",name:"el",checked:"Jā"===ee,onChange:()=>et("Jā")})," Ir"]}),(0,a.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[(0,a.jsx)("input",{type:"radio",name:"el",checked:"Nē"===ee,onChange:()=>et("Nē")})," Nav"]})]})}),6===_&&(0,a.jsx)(B,{title:"6. Vai nepieciešama žāvēšana?",children:(0,a.jsx)(L,{label:"Žāvēšana",children:c.map(e=>(0,a.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:8,marginRight:16},children:[(0,a.jsx)("input",{type:"radio",name:"dry",checked:el===e,onChange:()=>ea(e)})," ",e]},e))})}),7===_&&(0,a.jsx)(B,{title:"7. Vai bojāts kopīpašums?",children:(0,a.jsx)(L,{label:"Kopīpašums",children:c.map(e=>(0,a.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:8,marginRight:16},children:[(0,a.jsx)("input",{type:"radio",name:"common",checked:ei===e,onChange:()=>en(e)})," ",e]},e))})}),8===_&&(0,a.jsxs)(B,{title:"8. Zaudējuma novērtējums pēc klienta vārdiem",children:[(0,a.jsx)(L,{label:"Vai ir zināma summa?",children:c.map(e=>(0,a.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:8,marginRight:16},children:[(0,a.jsx)("input",{type:"radio",name:"loss",checked:er===e,onChange:()=>eo(e)})," ",e]},e))}),"Jā"===er&&(0,a.jsx)(L,{label:"Summa EUR",children:(0,a.jsx)("input",{type:"number",inputMode:"decimal",step:"0.01",value:null!=es?es:"",onChange:eF(ec),autoComplete:"off",style:{width:200,border:"1px solid #e5e7eb",borderRadius:10,padding:8},placeholder:"€ summa"})})]}),9===_&&(0,a.jsx)(B,{title:"9. Izvēlies telpu/as, kas tika bojātas",children:(0,a.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(240px,1fr))",gap:12},children:g.map(e=>{var t;return(0,a.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12},children:[(0,a.jsxs)("label",{style:{fontWeight:600,display:"flex",alignItems:"center",gap:8},children:[(0,a.jsx)("input",{type:"checkbox",checked:eu[e].checked,onChange:t=>ed({...eu,[e]:{...eu[e],checked:t.target.checked}})}),e]}),eu[e].checked&&(0,a.jsxs)("div",{style:{marginTop:8},children:["Cits"===e&&(0,a.jsx)("input",{value:String(null!=(t=eu[e].custom)?t:""),onChange:t=>ed({...eu,[e]:{...eu[e],custom:t.currentTarget.value}}),placeholder:"Telpas nosaukums",autoComplete:"off",style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8,marginBottom:8}}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,a.jsx)("span",{children:"Daudzums:"}),(0,a.jsx)("input",{type:"number",min:1,value:eu[e].count,onChange:t=>ed({...eu,[e]:{...eu[e],count:Math.max(1,Number(t.target.value||1))}}),style:{width:90,border:"1px solid #e5e7eb",borderRadius:10,padding:6}})]})]})]},e)})})}),10===_&&(0,a.jsxs)(B,{title:"10. Izvēlētās telpas",children:[0===em.length?(0,a.jsx)("div",{style:{color:"#6b7280"},children:"Nav izvēlētas telpas 9. solī."}):(0,a.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))",gap:12},children:em.map(e=>{let t=(eg[e.id]||[]).filter(e=>e.itemUid&&e.quantity).length,l=(e.id,[]);return(0,a.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#f9fafb"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:6},children:[(0,a.jsxs)("div",{style:{fontWeight:700},children:[e.type," ",e.index]}),(0,a.jsx)("button",{type:"button",onClick:()=>(function(e){let[t,l]=String(e).split("-"),a=parseInt(l,10)||1;eh(e=>{var l,i;let n={...e},r=(null==(l=eu[t])?void 0:l.checked)?Number((null==(i=eu[t])?void 0:i.count)||1):0;if(r<=0)return n;for(let e=a+1;e<=r;e++){let l="".concat(t,"-").concat(e),a="".concat(t,"-").concat(e-1);n[l]&&(n[a]=n[l])}return delete n["".concat(t,"-").concat(r)],n}),ed(e=>{let l=e[t];if(!l)return e;let a=(Number(l.count)||1)-1,i={...e};return a<=0?i[t]={...l,checked:!1,count:1}:i[t]={...l,checked:!0,count:a},i}),eb(t=>t===e?null:t)})(e.id),title:"Dzēst telpu",style:{marginLeft:"auto",padding:"4px 8px",borderRadius:8,border:"1px solid #e5e7eb",background:"white"},children:"Dzēst"})]}),(0,a.jsxs)("div",{style:{fontSize:13,color:"#4b5563",marginBottom:8},children:["Pozīcijas: ",t]}),l.length>0&&(0,a.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6,marginBottom:8},children:l.map(e=>(0,a.jsx)("span",{style:{background:"#e5e7eb",borderRadius:999,padding:"4px 10px",fontSize:12},children:e},e))}),(0,a.jsx)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:(0,a.jsx)("button",{type:"button",onClick:()=>{eb(e.id),A(11)},style:{padding:"8px 12px",borderRadius:10,background:"#111827",color:"white",border:0},children:"Atvērt"})})]},e.id)})}),em.length>0&&(0,a.jsxs)("div",{style:{marginTop:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsx)("button",{type:"button",onClick:()=>A(9),style:{padding:"10px 14px",borderRadius:10,border:"1px solid #e5e7eb",background:"white"},children:"+ Pievienot vēl telpu"}),em.every(e=>(eg[e.id]||[]).some(e=>e.itemUid&&e.quantity))&&(0,a.jsx)("button",{type:"button",onClick:eD,style:{padding:"12px 16px",borderRadius:12,background:"#059669",color:"white",border:0},children:"Viss pabeigts — izveidot tāmi"})]})]}),11===_&&ef&&(0,a.jsxs)(B,{title:"11. Pozīcijas un apjomi – ".concat(null==(e=em.find(e=>e.id===ef))?void 0:e.type," ").concat(null==(t=em.find(e=>e.id===ef))?void 0:t.index),children:[(0,a.jsx)(L,{label:"Piezīmes",children:(0,a.jsx)("input",{value:null!=(k=null==(y=em.find(e=>e.id===ef))?void 0:y.note)?k:"",onChange:e=>{var t;return t=e.target.value,void ep(e=>e.map(e=>e.id===ef?{...e,note:t}:e))},placeholder:"Papildus informācija",autoComplete:"off",style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8}})}),(0,a.jsx)("div",{style:{fontWeight:700,margin:"12px 0 6px"},children:"Pozīcijas un apjomi"}),(eg[ef]||[{category:"",itemUid:"",itemId:"",itemName:"",quantity:"",unit:"",unit_price:null}]).map((e,t)=>{var l,i,n;return(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1.1fr 2.2fr 1fr 0.8fr auto",gap:8,alignItems:"end",marginBottom:8},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontSize:13,marginBottom:4},children:"Kategorija"}),(0,a.jsxs)("select",{value:null!=(l=e.category)?l:"",onChange:e=>{var l;return l=e.target.value,void eh(e=>{let a=[...e[ef]||[]];return a[t]={...a[t],category:l,itemUid:"",itemId:"",itemName:"",unit:"",unit_price:null,labor:0,materials:0,mechanisms:0},{...e,[ef]:a}})},style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8,background:"white"},children:[(0,a.jsx)("option",{value:"",children:"— visas —"}),ez.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontSize:13,marginBottom:4},children:"Pozīcija"}),(0,a.jsxs)("select",{value:null!=(i=e.itemUid)?i:"",onChange:e=>(function(e,t,l){let a=ev.find(e=>e.uid===l);eh(l=>{let i=[...l[e]||[]];return a?i[t]={...i[t],category:a.category||i[t].category||"",itemUid:a.uid,itemId:a.id,itemName:a.name,unit:a.unit||"",unit_price:b(a,p),labor:b(a,u),materials:b(a,d),mechanisms:b(a,m)}:i[t]={...i[t],itemUid:"",itemId:"",itemName:"",unit:"",unit_price:null,labor:0,materials:0,mechanisms:0},{...l,[e]:i}})})(ef,t,e.target.value),style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8,background:"white"},children:[(0,a.jsx)("option",{value:"",children:"— izvēlies pozīciju —"}),ev.filter(t=>(!e.category||t.category===e.category)&&!z(t)).map(e=>(0,a.jsxs)("option",{value:e.uid,children:[e.subcategory?"[".concat(e.subcategory,"] "):"",e.name," \xb7 ",e.unit||"—"]},e.uid))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontSize:13,marginBottom:4},children:"Mērv."}),(0,a.jsxs)("select",{value:h(e.unit)||"",onChange:e=>e_(ef,t,"unit",h(e.target.value)),style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8,background:"white"},children:[(0,a.jsx)("option",{value:"",children:"—"}),eR.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontSize:13,marginBottom:4},children:"Daudz."}),(0,a.jsx)("input",{type:"number",min:0,step:"0.01",value:null!=(n=e.quantity)?n:"",onChange:e=>e_(ef,t,"quantity",e.target.value),style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:10,padding:8},autoComplete:"off",placeholder:"Skaitlis"})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",justifyContent:"flex-end"},children:[(0,a.jsx)("button",{type:"button",onClick:()=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";eh(l=>({...l,[e]:[...l[e]||[],{category:t||"",itemUid:"",itemId:"",itemName:"",quantity:"",unit:"",unit_price:null}]}))})(ef,e.category||""),style:{padding:"8px 12px",borderRadius:10,background:"#111827",color:"white",border:0},children:"+ Rinda"}),(0,a.jsx)("button",{type:"button",onClick:()=>{eh(e=>{let l=e[ef]||[];return l.length<=1?e:{...e,[ef]:l.filter((e,l)=>l!==t)}})},style:{padding:"8px 12px",borderRadius:10,border:"1px solid #e5e7eb",background:"white"},children:"Dzēst"}),(0,a.jsx)("button",{type:"button",onClick:()=>{eb(null),A(9)},style:{padding:"10px 14px",borderRadius:10,border:"1px solid #e5e7eb",background:"white",color:"#111827"},children:"+ Pievienot vēl telpu"})]})]},t)}),(0,a.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:(0,a.jsx)("button",{type:"button",onClick:()=>{eb(null),A(10)},style:{padding:"10px 14px",borderRadius:10,background:"#111827",color:"white",border:0},children:"Saglabāt un atgriezties"})})]}),[1,2,3,4,5,6,7,8,9,12].includes(_)&&(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:16},children:[(0,a.jsx)("button",{type:"button",onClick:()=>A(e=>Math.max(1,e-1)),disabled:1===_,style:{padding:"10px 14px",borderRadius:10,border:"1px solid #e5e7eb",background:1===_?"#f3f4f6":"white",color:"#111827"},children:"← Atpakaļ"}),(0,a.jsx)("button",{type:"button",onClick:()=>A(e=>Math.min(12,e+1)),disabled:!eA||12===_,style:{padding:"10px 14px",borderRadius:10,background:eA&&12!==_?"#111827":"#9ca3af",color:"white",border:0},children:12===_?"Beigas":"Tālāk →"})]}),(0,a.jsxs)("div",{style:{background:"white",padding:16,borderRadius:12,marginTop:20},children:[(0,a.jsx)("div",{style:{fontWeight:700,marginBottom:8},children:"Saglabātās tāmēs (šajā pārlūkā)"}),0===eL.length?(0,a.jsx)("div",{style:{color:"#6b7280"},children:"Vēl nav saglabātu tāmju."}):(0,a.jsx)("div",{style:{overflowX:"auto"},children:(0,a.jsxs)("table",{style:{width:"100%",fontSize:14},children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{style:{textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:[(0,a.jsx)("th",{style:{padding:"8px 12px"},children:"Fails"}),(0,a.jsx)("th",{style:{padding:"8px 12px"},children:"Tāmētājs"}),(0,a.jsx)("th",{style:{padding:"8px 12px"},children:"Datums"})]})}),(0,a.jsx)("tbody",{children:eL.map(e=>(0,a.jsxs)("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[(0,a.jsx)("td",{style:{padding:"8px 12px",fontFamily:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace"},children:e.filename}),(0,a.jsx)("td",{style:{padding:"8px 12px"},children:e.estimator}),(0,a.jsx)("td",{style:{padding:"8px 12px"},children:new Date(e.createdAtISO).toLocaleString()})]},e.id))})]})})]}),(0,a.jsx)("footer",{style:{paddingBottom:40,marginTop:12,fontSize:12,color:"#6b7280"},children:"Piezīme: forma nerāda apakšpozīcijas; Excel tās pievieno automātiski (saites, iebūvētie vai blakus esošie)."})]})})}}}]);